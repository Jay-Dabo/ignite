<p>
  <a class="btn btn-primary" data-toggle="collapse" href="#reading_progress" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Readings Progress</a>
</p>
<div class="row">
  <div class="col">
    <div class="collapse multi-collapse" id="reading_progress">
      <div class="card card-body">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">ID</th>
              <th scope="col">Title</th>
              <th scope="col">Reader Count</th>
            </tr>
          </thead>
          <tbody>
            <% if can? :manage, SpiritCharge %>
              <% @spirit_charges.each do |spirit| %>
                <tr>
                  <th scope="row"><%= spirit.id %></th>
                  <td><%= spirit.title %></td>
                  <td><%= "#{spirit.readings.size} reader(s) from #{@users.size}: #{(spirit.readings.size.to_f / @users.size.to_f) * 100}%" %></td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">First Name</th>
      <th scope="col">Email</th>
      <th scope="col" style="width: 350px;">Readings</th>
      <th scope="col">Need to Confirm</th>
    </tr>
  </thead>
  <tbody>
    <% if can? :manage, User %>
      <% @users.each do |user| %>
        <tr>
          <th scope="row"><%= user.id %></th>
          <td><%= user.firstname %></td>
          <td><%= user.email %></td>
          <td>
            <div class="progress">
              <% if readings_progress(user.readings).to_f < 25 %>
                <div class="progress-bar bg-danger" role="progressbar" style="width: <%= readings_progress(user.readings) %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= readings_progress(user.readings) %>%</div>
              <% elsif readings_progress(user.readings).to_f < 50 %>
                <div class="progress-bar bg-warning" role="progressbar" style="width: <%= readings_progress(user.readings) %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= readings_progress(user.readings) %>%</div>
              <% elsif readings_progress(user.readings).to_f < 75 %>
                <div class="progress-bar bg-info" role="progressbar" style="width: <%= readings_progress(user.readings) %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= readings_progress(user.readings) %>%</div>
              <% elsif readings_progress(user.readings).to_f >= 75 %>
                <div class="progress-bar bg-success" role="progressbar" style="width: <%= readings_progress(user.readings) %>%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"><%= readings_progress(user.readings) %>%</div>
              <% end %>
            </div>
          </td>
          <td>
            <!-- Some actions here -->
            <% if (can? :manage, User) && !user.confirmed? %>
              <%= link_to confirm_users_path(id: user.id) do %>
                <i class="fas fa-check-double"></i>
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
